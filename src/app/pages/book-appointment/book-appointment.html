<div class="booking-container">
  <a routerLink="/doctors" class="back-link">← Back to doctors</a>

  @if (appointmentDetails(); as data) {
    <div class="content-grid">
      <div class="summary-card">
        <h2>Booking Summary</h2>
        <div class="doctor-preview">
          <div class="avatar">{{ getInitials(data.doctor.name) }}</div>
          <div>
            <h3>{{ data.doctor.name }}</h3>
            <p class="specialty">{{ data.doctor.specialty }}</p>
          </div>
        </div>
        
        <div class="details-list">
          <div class="detail-item">
            <span class="label">Date</span>
            <span class="value">{{ data.slot.slot_date }}</span>
          </div>
          <div class="detail-item">
            <span class="label">Time</span>
            <span class="value highlight">{{ data.slot.slot_time }}</span>
          </div>
          <div class="detail-item">
            <span class="label">Rating</span>
            <span class="value">★ {{ data.doctor.rating || 'N/A' }}</span>
          </div>
        </div>
      </div>

      <div class="form-card">
        <h2>Patient Details</h2>
        <form [formGroup]="bookingForm" (ngSubmit)="onSubmit()">
          <div class="form-group">
            <label>Full Name</label>
            <input type="text" formControlName="patientName" placeholder="Enter your name">
          </div>

          <div class="form-group">
            <label>Mobile Number</label>
            <input type="tel" formControlName="mobileNumber" placeholder="10-digit number">
          </div>

          <div class="form-group">
            <label>Email Address</label>
            <input type="email" formControlName="email" placeholder="email@example.com">
          </div>

          <button type="submit" class="btn-confirm" [disabled]="isSubmitting()">
            {{ isSubmitting() ? 'Processing...' : 'Confirm Appointment' }}
          </button>
        </form>
      </div>
    </div>
  } @else {
    <div class="loading-state">
      <p>Finding appointment details...</p>
    </div>
  }

  @if (showSuccess()) {
  <div class="success-overlay">
    <div class="success-card">
      <div class="icon-container">
        <div class="check">✓</div>
        <div class="confetti"></div>
      </div>
      
      <h2>Booking Confirmed!</h2>
      
      <div class="confirmation-details">
        <p class="main-msg">Journey Step Completed Successfully.</p>
        
        <div class="email-badge">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
          <span>Confirmation email sent to <strong>{{ bookingForm.get('email')?.value }}</strong></span>
        </div>

        <p class="navigator-note">
          Your <strong>Digital Care Navigator</strong> is now tracking this journey. 
          Expect a reminder 2 hours before your appointment.
        </p>
      </div>

      <div class="auto-redirect">
        Redirecting to dashboard...
      </div>
    </div>
  </div>
}
</div>